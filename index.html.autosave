<!DOCTYPE html>
<html manifest="./websocket.manifest">
<head>
    <title>Qiddler 类Fiddler工具</title>
    <link rel="stylesheet" type="text/css" href="../jo2_lib/jo2.css">
    <link rel="stylesheet" type="text/css" href="../wsAPI/index.css">
    <style>
        .container{
            display:-webkit-box;
            -webkit-box-orient:horizontal;
        }
    </style>
</head>
<body>
    <input type="text" id="addr" value="ws://127.0.0.1:9828"/>
    <div class="button" id="connectBtn">connect</div>
    <input type="text" id="message" value="say something"/>
    <div class="button" id="sendBtn">send</div>
    <div class="button" id="closeBtn">close</div>
    <script src="../jo2_lib/jo2.js"></script>
<script src="../jo2_lib/jo2.string.js"></script>
    <script src="../jo2_lib/jo2.template.js"></script>
    <script src="../jo2_lib/jo2.dom.js"></script>
    <script src="../jo2_lib/jo2.console.js"></script>
    <script src="../wsAPI/index.js"></script>
<div class="container">
    <div>
        <label for="pattern">规则</label><input type="text" id="pattern" /><br/>
        <label for="replace">规则</label><input type="text" id="replace" /><input type="file" style="display:none" id="selectFile"/><br/>
        <label for="ruleType">规则</label><select id="ruleType">
            <option value="1">simple host</option>
            <option value="2" title="可以cgi路径为同一domain设置host">complex host</option>
            <option value="3">local content replace</option>
            <option value="4">remote content repalce</option>
        </select><br/>
        <button onclick="addRule(event)">add rule</button>
    </div>
</div>
<script>
    function $(id){return document.getElementById(id);}
    function init(){
        $('ruleType').onchange=function(){
            if(this.value == 3){
                $('selectFile').style["display"]="";
            }else{
                $('selectFile').style["display"]="none";
            }
        }
        $('selectFile').onchange=function(){
            $('replace').value = this.value;
        }
    }
    function addRule(){
        $('selectFile
        var msg = $('ruleType').value+'\x01'+$('pattern').value+'\x01'+$('replace').value;
        sendMsg(msg);
    }
    window.onload = init;
</script>


</body>
</html>
